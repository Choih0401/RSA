from Crypto.Util.number import *

def egcd(a, b):
    x,y, u,v = 0,1, 1,0
    while a != 0:
        q, r = b//a, b%a
        m, n = x-u*q, y-v*q
        b,a, x,y, u,v = a,r, u,v, m,n
        gcd = b
    return gcd, x, y

def main():
    p = 154132488051951595251856392984746022988466343822199990975298904657572571924706986069110583551775051598091595800465570108934440419552907890079817993243575623218998352899477163520619029738535546691928691567613716300210804427407214391050011375203890327318258039249301353381912386953144429693592382911679017990039
    e = 65537
    ct = 14404443124604970966119725180350360573026161915963081562976272127262984077081413154656479085688249678292524613989840020937668629485022804050798009802381222968693288751990446374542687522666084223240999167176842070757001957131152052050496727464689897884390203233050261708358039257483202703186719958699152198717680165019024541006178216660884159063986496065405695324515072449426392092504473528261948471815209896113991991486426714739762604681581537450791434972146656640773422583089397641273238943001393659565068283643467458942834851877172414131271895358765046699028989087758948724750583400498727015297783311821751661156038002247559873377089766420267384516084822074381315981300355119277119693878260354961590165339256761081666919074907404562920135527003979319115608917917375900543146855947864206818667326543046334475
    n = 15413248805195159525185639298474602298846634382219999097529890465757257192470698606911058355177505159809159580046557010893444041955290789007981799324357562321899835289947716352061902973853554669192869156761371630021080442740721439105001137520389032731825803924930135338191238695314442969359238291167901799003900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000148121321017925483037033993658340928091916156413134191327262247375927241619643413612415270793255824585766023564247412874685997243190344482366705091507076173913457417136397554143314887578732660370943472596476781364502583054738333029799060931570938604552845975718578600600017803861971796935542279978123536288427479
    q = n / p 
    #print("n : " + str(n))

    phi = (p - 1) * (q - 1)

    gcd, a, b = egcd(e, phi)
    if(a < 0):
        d = a + phi
    else:
        d = a

    #print( "d: " + str(d) )

    pt = pow(ct,d,n)
    print( "pt: " + str(long_to_bytes(pt)) )

if __name__ == "__main__":
    main()
